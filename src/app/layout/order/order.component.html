<div>
  <app-page-header [heading]="'Orders'" [icon]="'fa-table'"></app-page-header>
  <div class="row">
    <div class="col col-xl-12 col-lg-12">
        <div class=" breadcrumb">
            <label > Select by City</label>
           <select  style = "background-color: inherit; margin-left: 8px" [(ngModel)]="CityId" (change) = "SelectByCity ()"> 
             <option selected hidden> Select by City </option>
             <option *ngFor="let city of cities" [value]="city.Id">{{city.Name}}</option>
           </select>
          </div>
      <div class="card mb-3">
        <div class="card-header">
          List of Orders 
        </div>
        <div class="card-body table">
            <ngb-tabset>
                <ngb-tab title="All">
                    <ng-template ngbTabContent>


          <table class="table table-hover table-striped text-center">
            <thead>
              <tr>
                <th>#</th>
                <th>City</th>
                <th>Sub Total</th>
                <th>Fee</th>
                <th>GST</th>
                <th>Grand Total</th>
                <th>Created</th>
                <th>Status</th>
                <th>Customer</th>
                <th>Order Items</th>
                <th>Rider</th>
              </tr>
            </thead>
            <tbody *ngIf="!isLoading">
               <tr *ngFor="let order of CityOrders; let i = index">   
                <th scope="row">{{ i + 1 }}</th>
                <td *ngIf="order.City">{{ order.City.Name }}</td>
                <td>{{ order.Subtotal }}</td>
                <td>{{ order.Fee }}</td>
                <td>{{ order.GST }}</td>
                <td>{{ order.GrandTotal }}</td>
                <td>{{ order.Created }}</td>
                <td>{{ order.OrderStatus }}</td>
                <td *ngIf="order.Customer">{{ order.Customer.Name }}</td>
                <td><a routerLink="{{order.Id}}">view Items</a>&nbsp;</td>
                <td><a >Rider</a>&nbsp;</td>
              </tr>
            </tbody>

          </table>
          </ng-template>
                </ngb-tab>
   
             <!-- new Orders tab -->
                <ngb-tab title="New"> 
                  <ng-template ngbTabContent>
                      <table class="table table-hover table-striped text-center">
                          <thead>
                            <tr>
                              <th>#</th>
                              <th>City</th>
                              <th>Sub Total</th>
                              <th>Fee</th>
                              <th>GST</th>
                              <th>Grand Total</th>
                              <th>Created</th>
                              <th>Status</th>
                              <th>Customer</th>
                              <th>Order Items</th>
                              <th>Rider</th>
                            </tr>
                          </thead>
                          <tbody *ngIf="!isLoading">
                             <tr *ngFor="let order of NewOrders; let i = index" >   
                              <th scope="row">{{ i + 1 }}</th>
                              <td>{{ order.City.Name }}</td>
                              <td>{{ order.Subtotal }}</td>
                              <td>{{ order.Fee }}</td>
                              <td>{{ order.GST }}</td>
                              <td>{{ order.GrandTotal }}</td>
                              <td>{{ order.Created }}</td>
                              <!-- <td>{{ order.Status }}</td> -->
                              <td>  <select style = "background-color: inherit" [(ngModel)]="OrderStatus"
                                      (change)  = "editOrderStatus(order.Id)" >
                                <option [value] = 1> Active </option>
                                <option [value] = 2> Completed </option>
                                <option [value] = 3> Cancelled </option>
                              </select> {{OrderStatus}}
                            </td>
                              <td>{{ order.Customer.Name }}</td>
                              <td><a routerLink="{{order.Id}}">view Items</a>&nbsp;</td>
                              <td> 
                                <select rider style = "background-color: inherit" [(ngModel)]="RiderId"
                                        (change)  = "editOrderRider(order.Id)"  >
                                  <option selected hidden>Rider</option>
                                  <option *ngFor="let rider of riders" [value]="rider.Id">
                                    {{rider.Name}}
                                  </option>
                                </select>
                                {{RiderId}}
                              </td>
                            </tr>
                          </tbody>
                        </table>
                  </ng-template>
                </ngb-tab>
              
                <!-- Active orders Tab  -->
                <ngb-tab title="Active"> 
                  <ng-template ngbTabContent>
                      <table class="table table-hover table-striped text-center">
                          <thead>
                            <tr>
                              <th>#</th>
                              <th>City</th>
                              <th>Sub Total</th>
                              <th>Fee</th>
                              <th>GST</th>
                              <th>Grand Total</th>
                              <th>Created</th>
                              <th>Status</th>
                              <th>Customer</th>
                              <th>Order Items</th>
                              <th>Rider</th>
                            </tr>
                          </thead>
                          <tbody *ngIf="!isLoading">
                             <tr *ngFor="let order of ActiveOrders; let i = index" >   
                              <th scope="row">{{ i + 1 }}</th>
                              <td>{{ order.City.Name }}</td>
                              <td>{{ order.Subtotal }}</td>
                              <td>{{ order.Fee }}</td>
                              <td>{{ order.GST }}</td>
                              <td>{{ order.GrandTotal }}</td>
                              <td>{{ order.Created }}</td>
                              <!-- <td>{{ order.Status }}</td> -->
                              <td>  <select style = "background-color: inherit" [(ngModel)]="OrderStatus"
                                      (change)  = "editOrderStatus(order.Id)" >
                                <option [value] = 2> Completed </option>
                                <option [value] = 3> Cancelled </option>
                              </select> {{OrderStatus}}
                            </td>
                              <td>{{ order.Customer.Name }}</td>
                              <td><a routerLink="{{order.Id}}">view Items</a>&nbsp;</td>
                              <td> 
                                {{RiderId}}
                              </td>
                            </tr>
                          </tbody>
                        </table>
                  </ng-template>
                </ngb-tab>
                 <!-- Complete orders Tab  -->
                 <ngb-tab title="Complete"> 
                  <ng-template ngbTabContent>
                      <table class="table table-hover table-striped text-center">
                          <thead>
                            <tr>
                              <th>#</th>
                              <th>City</th>
                              <th>Sub Total</th>
                              <th>Fee</th>
                              <th>GST</th>
                              <th>Grand Total</th>
                              <th>Created</th>
                              <th>Status</th>
                              <th>Customer</th>
                              <th>Order Items</th>
                              <th>Rider</th>
                            </tr>
                          </thead>
                          <tbody *ngIf="!isLoading">
                             <tr *ngFor="let order of CompleteOrders; let i = index" >   
                              <th scope="row">{{ i + 1 }}</th>
                              <td>{{ order.City.Name }}</td>
                              <td>{{ order.Subtotal }}</td>
                              <td>{{ order.Fee }}</td>
                              <td>{{ order.GST }}</td>
                              <td>{{ order.GrandTotal }}</td>
                              <td>{{ order.Created }}</td>
                              <!-- <td>{{ order.Status }}</td> -->
                              <td>   Complete   </td>
                              <td>{{ order.Customer.Name }}</td>
                              <td><a routerLink="{{order.Id}}">view Items</a>&nbsp;</td>
                              <td> 
                                {{RiderId}}
                              </td>
                            </tr>
                          </tbody>
                        </table>
                  </ng-template>
                </ngb-tab>
            </ngb-tabset>


        </div>
      </div>
    </div>
  </div>

